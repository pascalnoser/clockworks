% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/CircadianData.R
\name{filter_samples}
\alias{filter_samples}
\title{Filter Samples in a CircadianData Object}
\usage{
filter_samples(cd_obj, filter_expr)
}
\arguments{
\item{cd_obj}{A \code{CircadianData} object.}

\item{filter_expr}{An expression that evaluates to a logical vector within
the context of the object's metadata. Use column names from
\code{metadata(cd_obj)} directly in the expression.}
}
\value{
A new \code{CircadianData} object containing only the samples that
satisfy the \code{filter_expr}.
}
\description{
Subsets a \code{CircadianData} object by rows of its metadata using a flexible
filtering expression, similar to \code{dplyr::filter()}.
}
\examples{
# --- Setup ----
counts <- matrix(rpois(80, 50), nrow=10, ncol=8,
                 dimnames=list(paste0("Feature", 1:10), paste0("Sample", 1:8)))
meta_df <- data.frame(
  sample_id = paste0("Sample", 1:8),
  time = rep(c(0, 6, 12, 18), each = 2),
  group = rep(c("Control", "Treated"), 4)
)
cd_obj <- CircadianData(
  dataset = counts, metadata = meta_df,
  colname_sample = "sample_id", colname_time = "time", colname_group = "group"
)

# --- Filtering Examples ---

# Filter for a single group
cd_control <- filter_samples(cd_obj, group == "Control")
print(metadata(cd_control))

# Filter for a time range
cd_late <- filter_samples(cd_obj, time >= 12)
print(metadata(cd_late))

# Combine conditions
cd_filtered <- filter_samples(cd_obj, group == "Treated" & time < 12)
print(metadata(cd_filtered))

}
